<!DOCTYPE html>
<html>
<head>
  <title>Parent Page</title>

  <!-- Google Tag Manager (Head) -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id=' + i + dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-XXXXXXX'); // Replace with your GTM ID
  </script>
  <!-- End GTM Head -->

  <script>
    // Listen for messages from the iframe
    window.addEventListener('message', function(event) {
      // Optional: Security check - validate origin
      // if (event.origin !== 'https://your-iframe-origin.com') return;

      if (event.data && event.data.event === 'customEventFromIframe') {
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
          event: 'iframeCustomEvent',       // Trigger this in GTM
          iframeData: event.data.data       // You can use this in your tag
        });
        console.log('Message received and pushed to dataLayer:', event.data);
      }
    });
  </script>
</head>
<body>
  <!-- Google Tag Manager (Body) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End GTM Body -->

  <h1>Parent Page</h1>

  <iframe src="iframe.html" width="400" height="200" style="border:1px solid #ccc;"></iframe>
</body>
</html>